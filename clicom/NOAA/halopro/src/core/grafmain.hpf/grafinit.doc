$STORAGE:2 
      PROGRAM GRAFINIT
.
.      
C       .. ARRAY BUFFER USED BY SELAREA AND WNDSMRY TO SAVE SPACE
C          MNBUFSZ IS THE MINIMUM ARRAY SIZE REQUIRED BY WNDSMRY FOR BUFFER
C          I1BUF IS A WORK ARRAY USED BY THE ROUTINE DFSTNLST; TO REDUCE 
C          EXECUTABLE SIZE, IT OCCUPIES THE SAME SPACE AS BUFFER
      PARAMETER (MNBUFSZ=51*16*13)     -----|----->> STMT MOVED; I*4 TO I*2
$INCLUDE:  'SAVBUF.INC'                     |_____>> MXI4WRK CHANGED TO MNBUFSZ
.
.
      INTEGER*2 MSGNBR(7)
      LOGICAL APIOPN,ESCFLG                          --------->> MOVE LINE 
C       .. NRCD AND MAXROW ARE DEFINED IN GRFPARM.INC
      REAL*4 HLDARRAY(NRCD)
      CHARACTER*12 ROWHDR(MAXROW)
      COMMON /GRAFINSV/ HLDARRAY,ROWHDR               -------->> ADD LINE    
C      
C       .. MAXROW, DEFINED IN GRFPARM.INC, IS THE DIMENSION OF LATLIST/LONLIST
C          LATLIST AND LONLIST ARE DEFINED IN ROUTINE SELAREA.  THEY ARE 
C          NOT PASSED AS ARGUMENTS BUT RATHER THE COMMON BLOCK /LTLNSTN/
C          IS INCLUDED IN SELAREA.  THIS ALLOWS I2WRK TO BE PASSED AS AN
C          ARGUMENT TO THE ROUTINES THAT PRODUCE A USER DEFINED STATION
C          SELECTION LIST.  THE ROUTINES THAT USE I2WRK COMPLETE THEIR
C          PROCESSING BEFORE VALUES ARE DEFINED FOR LATLIST AND LONLIST.
C      
C       .. I2WRK IS A WORK ARRAY USED BY THE ROUTINE DFSTNLST; TO REDUCE 
C          EXECUTABLE SIZE, IT OCCUPIES THE SAME SPACE AS LATLIST AND LONLIST
$INCLUDE: 'LTLNSTN.INC'                    -------->> REVISE COMMON /SCRATCH/
C                                     
$INCLUDE: 'VAL1.INC'
$INCLUDE: 'INDEX.INC'
.
.
C       ** BEGIN PROGRAM CODE  ------------------------------------------------
C
C       ** CHECK THAT ARRAY BUFFER MEETS MINIMUM SIZE REQUIREMENTS OF
C          ROUTINE WNDSMRY; BUFFER IS LOADED FOR GRAPHICS SECTION OF
C          WRTGRAF.  SINCE NO GRAPHICS ARE USED IN GRAFINIT, THIS ARRAY
C          SPACE IS USED BY SELAREA AND WNDSMRY TO SAVE SPACE.
C
      IF (MNBUFSZ.GT.IBUFD) THEN                  -------->> MXI4WRK TO MNBUFSZ
         CALL WRTMSG(3,596,12,1,1,' ',0)
         CALL LOCATE(24,0,IERR)
         STOP 7
      ENDIF         
.
.
C
C   FOR A MAP, ASK USER FOR THE AREA WANTED. A LIST OF STATIONS WITHIN
C   THE LAT AND LON BOUNDARIES IS GENERATED AUTOMATICALLY.
C 
      CALL CLS
      CALL LOCATE(0,5,IERR)
      IF (IGRAPH.EQ.2) THEN
C          .. BUFFER(I*4) IS EQUIVALENCED TO I1BUF(I*1) -- INITIAL AS I*1      
         DO 128 I=1,MAXBYT                                 -------->> ADD LINE
            I1BUF(I) = 0                                   -------->> ADD LINE
  128    CONTINUE                                          -------->> ADD LINE
         CALL SELAREA(I1BUF,MAXBYT,LOWLAT,HILAT,LOWLON,HILON, ----->> REVISE
     +                MXDATROW,RTNFLAG)                       ----->> ARGUMENTS
C          .. BUFFER(I*4) IS EQUIVALENCED TO I1BUF(I*1) -- INITIAL AS I*4
         DO 129 I=1,IBUFD                                  -------->> ADD LINE
            BUFFER(I) = 0                                  -------->> ADD LINE
  129    CONTINUE                                          -------->> ADD LINE
